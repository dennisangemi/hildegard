#!/bin/bash

# this script will build the md page for the site
# this script is called by build.sh and the variables are shared

# to do
# - [ ] trasformare il check delle linee e il print di nessun risultato in una funzione che accetta come argomento il file da controllare

# functions 
check_and_print() {
   # se il file con i suggerimenti ha più di una riga, concatena i contenuti al file della homepage, altrimenti aggiungi alla home un messaggio di "nessun risultato"
   local file_path=$1
   if [ $(wc -l < "$file_path") -gt 1 ]; then
      mlr --c2m cat "$file_path" >> $PATH_HOMEPAGE
   else
      echo '!!! info "Nessun risultato"' >> $PATH_HOMEPAGE
      echo "    Purtroppo il suggeritore automatico non è stato in grado di ottenere nessun buon risultato per questa sezione ;(" >> $PATH_HOMEPAGE
   fi
}

# import variables
# source <(grep = scripts/config.ini)

# copy template to output file
cp $PATH_TEMPLATE $PATH_HOMEPAGE

# replace date placeholder with current date
sed -i "s#$PLACEHOLDER_DATE#$liturgia_weekday $liturgia_data_estesa#g" $PATH_HOMEPAGE

# create archive file
# ARCHIVE_FILE_PATH="docs/archive/$liturgia_data_estesa.md"

# replace url liturgia cei placeholder with url liturgia cei
sed -i "s#$PLACEHOLDER_URL_CEI#$URL_LITURGIA_CEI$liturgia_data_yyyymmdd#g" $PATH_HOMEPAGE



